<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Laporan LEMBUR PLN</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/daisyui@2.51.4/dist/full.css" rel="stylesheet" type="text/css" />

  <script
  src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
  integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg=="
  crossorigin="anonymous"
  referrerpolicy="no-referrer"
></script>
</head>
<body class="bg-white-100 p-6">
  <div class="w-full p-4 bg-white">
    <button
    id="download123"
    type="button"
    class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800"
  >
    Download PDF
  </button>
  <div id="laporan-wrapper" class="overflow-x-auto ">
    <table id="laporan" class="w-auto mx-auto text-xs block px-4">
      <!-- Table Title -->
      <thead>
        <tr>
          <th colspan=12" class="border-b border-gray-800 px-4 py-2 text-center">
          
            <div class="font-semibold text-sm mt-1">
              <br>REKAPITULASI KERJA LEMBUR OUTSOURCING <br />
              UPT BANDA ACEH <br>
            </div>
          </th>
        </tr>
        <!-- Column Headers -->
        <tr>
          <th rowspan="2" class="border border-gray-800 px-2 py-1 text-center align-middle break-words">No</th>
          <th rowspan="2" class="border border-gray-800 px-2 py-1 text-center align-middle">Hari</th>
          <th rowspan="2" class="border border-gray-800 px-2 py-1 text-center align-middle">Tanggal</th>
          <th rowspan="2" class="border border-gray-800 px-2 py-1 text-center align-middle">Nama Outsourcing</th>
          <th rowspan="2" class="border border-gray-800 px-2 py-1 text-center align-middle">Unit</th>
          <th rowspan="2" class="border border-gray-800 px-2 py-1 text-center align-middle">Rincian Pekerjaan</th>
          <th rowspan="2" class="border border-gray-800 px-2 py-1 text-center align-middle">Jam Mulai</th>
          <th rowspan="2" class="border border-gray-800 px-2 py-1 text-center align-middle">Jam Selesai</th>
          <th rowspan="2" class="border border-gray-800 px-2 py-1 text-center align-middle">Total Jam Lembur</th>
          <th rowspan="2" class="border border-gray-800 px-2 py-1 text-center align-middle break-word">Total Jam Yang Dibayarkan</th>
          <th rowspan="2" class="border border-gray-800 px-2 py-1 text-center align-middle">Upah Per Jam</th>
          <th rowspan="2" class="border border-gray-800 px-2 py-1 text-center align-middle">Biaya Yang Dibayarkan</th>
        
        
        
        </tr>
      
      </thead>
      <!-- New Row -->
<tr>
  <td colspan="12" class="border border-gray-800 px-4 py-2 text-center font-semibold">
    <span id="transaction-month"></span>
  </td>
</tr>
      <tbody id="data-table-body">

      </tbody>
      <tfoot>
        <!-- Summary Rows -->
        <tr>
          <td colspan="9" class="border border-gray-800 px-2 py-1 font-semibold text-left"></td>
          <td colspan="2" class="border border-gray-800 px-2 py-1 font-semibold text-left">Jumlah</td>
          <td class="border border-gray-800 px-2 py-1 text-right" id="total-amount"></td>
        </tr>
        <tr>
          <td colspan="9" class="border border-gray-800 px-2 py-1 font-semibold text-left"></td>
          <td colspan="2" class="border border-gray-800 px-2 py-1 font-semibold text-left">Biaya Admin (5%)</td>
          <td class="border border-gray-800 px-2 py-1 text-right" id="total-biaya-admin"></td>
        </tr>
        <tr>
          <td colspan="9" class="border border-gray-800 px-2 py-1 font-semibold text-left"></td>
          <td colspan="2" class="border border-gray-800 px-2 py-1 font-semibold text-left">
            Total Tagihan SPPD <span id="transaction-month"></span>
          </td>
          <td class="border border-gray-800 px-2 py-1 text-right" id="total-invoice-without-tax"></td>
        </tr>
        <tr>
          <td colspan="9" class="border border-gray-800 px-2 py-1 font-semibold text-left"></td>
          <td colspan="2" class="border border-gray-800 px-2 py-1 font-semibold text-left">PPN 11%</td>
          <td class="border border-gray-800 px-2 py-1 text-right" id="total-ppn"></td>
        </tr>
        <tr>
          <td colspan="9" class="border border-gray-800 px-2 py-1 font-semibold text-left"></td>
          <td colspan="2" class="border border-gray-800 px-2 py-1 font-semibold text-left">
            Total Tagihan SPPD <span id="transaction-month"></span> + PPN
          </td>
          <td class="border border-gray-800 px-2 py-1 text-right" id="total-final-invoice"></td>
        </tr>
        <tr>
          <td colspan="12" id="terbilang" class="italic border border-gray-800 px-2 py-1 font-semibold text-left">
            <span id="terbilang-amount">terbilang:</span>
          </td>
        </tr>
      
        <!-- Signature Section -->
        <tr>
          <td colspan="4" class="border-t border-gray-800 px-2 py-8 text-center align-bottom">
            DIREKSI LAPANGAN,<br> MANAGER<br><br><br><br><br><u>INDRA KURNIAWAN</u>
          </td>
          <td colspan="5"></td>
          <td colspan="3" class="border-t border-gray-800 px-2 py-8 text-center align-bottom">
            Banda Aceh, 15 <span id="bulan-masuk-tagihan"></span>
            <br>KSO<br> PT. PALMA NAFINDO PRATAMA - PT. SANOBAR GUNAJAYA<br><br><br><br><br><u>RIZKY NAHARDI</u>
          </td>
        </tr>
      </tfoot>
      
    </table>
  </div>
    <!-- Table -->

    <div id="bottom-tab-nav"></div>
  </div>


  <script>
      fetch('bottom-tab.html')
          .then(response => response.text())
          .then(data => {
              document.getElementById('bottom-tab-nav').innerHTML = data;
          });
  </script>
  <script src="lembur-frontend-report-pln.js"></script>
  <!-- <script>
    document.getElementById('download123').addEventListener('click', () => {
    console.log('clicked');
      const element = document.getElementById('laporan');
      html2pdf().from(element).save('Rekap Lembur Untuk PLN.pdf');
    });
  </script> -->
</body>
</html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
document.getElementById('download123').addEventListener('click', async () => {
    const { jsPDF } = window.jspdf;
    const element = document.getElementById('laporan');

    // Set up html2canvas options for better scaling and resolution
    const canvas = await html2canvas(element, {
        scale: 2, // High resolution for better clarity
        useCORS: true, // Ensure cross-origin support if needed
        logging: true
    });

    const imgData = canvas.toDataURL('image/png');
    const pdf = new jsPDF('l', 'pt', 'legal'); // 'l' for landscape, 'legal' for legal paper size
    pdf.margin = { horiz: 15, vert: 20 };
    const imgProps = pdf.getImageProperties(imgData);

    // Adjust dimensions for legal size
    const pdfWidth = pdf.internal.pageSize.getWidth();
    const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;

    let yPosition = 0; // Track vertical position for multi-page support

    // Split content across multiple pages if needed
    while (yPosition < imgProps.height) {
        pdf.addImage(imgData, 'PNG', 0, yPosition * -1, pdfWidth, pdfHeight);
        yPosition += pdf.internal.pageSize.getHeight(); // Move to next page height
        if (yPosition < imgProps.height) {
            pdf.addPage();
        }
    }

    // Save the generated PDF
    pdf.save('Rekap_Lembur_PLN.pdf');
});


</script>